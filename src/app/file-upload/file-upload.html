<!-- Header Section -->
<div class="white-container">
  <div class="header-section">
    <div class="title-container">
      <div class="cloud-icon"><svg xmlns="http://www.w3.org/2000/svg" height="38px" viewBox="0 -960 960 960" width="38px" fill="#2e5ca0"><path d="M261.7-140.78q-98.95 0-169.09-68.09-70.13-68.09-70.13-166.43 0-83.66 47.85-150.03 47.84-66.37 127.8-84.5 28.39-94.26 106.22-151.82 77.82-57.57 175.65-57.57 119.83 0 205 82.07 85.17 82.06 91.39 201.32 70.7 14.22 115.92 69.68 45.21 55.45 45.21 127.85 0 82.3-58.43 139.91-58.44 57.61-140.79 57.61H541.48q-43.73 0-74.86-31.14-31.14-31.14-31.14-74.86V-418.3l-67.96 67.08-62.22-61.65L480-588.13l174.7 175.26-62.22 61.65-67.96-67.08v171.52H738.3q38.61 0 65.92-27.31 27.3-27.3 27.3-65.91t-27.3-65.91q-27.31-27.31-65.92-27.31h-66.78v-88.48q0-79.48-56.02-135.5-56.02-56.02-135.5-56.02-80.74 0-136.13 59.07-55.39 59.06-55.39 140.93H261.7q-55.19 0-94.21 39.01-39.01 39.01-39.01 94.2 0 55.18 39.01 94.21 39.02 39.02 94.21 39.02h93.78v106H261.7ZM480-427Z"/></svg></div>
      <h1 class="main-title">GCS File Upload</h1>
    </div>
    
    <!-- User Profile Section with Dropdown -->
    <div class="user-profile-section">
      <span class="user-name">{{ currentUser?.username }}</span>
      <div class="user-avatar-container">
        <div class="user-avatar" (click)="toggleDropdown($event)">
          <svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="0 -960 960 960" width="100%" fill="#ffffff">
            <path d="M480-481.54q-57.75 0-98.87-41.12Q340-563.79 340-621.54q0-57.75 41.13-98.87 41.12-41.13 98.87-41.13 57.75 0 98.87 41.13Q620-679.29 620-621.54q0 57.75-41.13 98.88-41.12 41.12-98.87 41.12ZM180-187.69v-88.93q0-29.38 15.96-54.42 15.96-25.04 42.66-38.65 59.3-29.08 119.61-43.62 60.31-14.54 121.77-14.54t121.77 14.54q60.31 14.54 119.61 43.62 26.7 13.61 42.66 38.65Q780-306 780-276.62v88.93H180Z"/>
          </svg>
        </div>
        
        <!-- Dropdown Menu -->
        <div class="dropdown-menu" *ngIf="showDropdown">
          <div class="dropdown-item" (click)="logout()">
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="#495057">
              <path d="M180-140.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-466.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h264.48v106H180v466.44h264.48v106H180Zm447.52-179.7-73.69-76.61 98.3-98.3H387.09v-106h265.04l-98.3-98.3 73.69-76.61L855.83-548 627.52-320.48Z"/>
            </svg>
            <span>Logout</span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="subtitle-container"> 
      <p class="subtitle">Upload files to Google Cloud Storage with ease</p>
    </div>
  </div>
</div>




  


<div class="file-upload-container">
    <!-- Configuration Section -->
  <div class="configuration-section">
    <div class="section-header">
      <span class="settings-icon"><svg xmlns="http://www.w3.org/2000/svg" height="25px" viewBox="0 -960 960 960" width="25px" fill="#505558"><path d="m368.25-64.17-19.42-131.76q-13.24-4.63-28.15-13.27-14.91-8.64-26.23-17.52l-122.86 55.11L58.61-369.9l110.1-81.3q-1.1-6.45-1.44-14.4-.33-7.95-.33-14.4t.33-14.4q.34-7.95 1.44-14.4l-110.1-81.68 112.98-197.16 123.99 54.55q10.94-8.5 25.55-16.86 14.61-8.35 27.7-12.7l19.42-133.55h223.5l19.42 132.88q13.24 5.02 28.29 13.04 15.06 8.02 26.09 17.19l123.23-54.55 112.61 197.16-110.66 80.35q1.1 7.12 1.62 15.06.52 7.95.52 15.07t-.62 14.73q-.61 7.62-1.86 14.73l110.67 80.64-113.18 198.29-123.08-55.11q-11.32 8.88-25.6 17.66-14.27 8.79-28.03 13.13L591.75-64.17h-223.5Zm74.17-88.15h74.26l14.57-109.25q32.89-8 62.43-24.59t52.87-41.81l103.48 44.33 34.01-62.37-90.01-66.54q4.33-16.75 7.04-33.49 2.71-16.73 2.71-33.96t-2.37-33.96q-2.38-16.74-7.38-33.49l90.77-66.54-34.77-62.37-102.91 44.66q-22.67-26.31-52.06-44-29.39-17.68-63.81-23.11l-13.67-108.87h-75.01L429.32-699q-34.32 6.77-64.14 24.12-29.82 17.34-53.05 42.85l-102.35-44.33-34.58 62.37 89.45 65.64q-4.33 17.09-7.04 33.94-2.71 16.84-2.71 34.41 0 17.23 2.71 34.36t7.04 33.84l-89.45 65.79 34.58 62.37 102.35-44.48q23.9 24.8 53.81 41.96Q395.86-269 429.32-261l13.1 108.68Zm36.93-194.35q55.33 0 94.33-39t39-94.33q0-55.33-39-94.33t-94.33-39q-55.48 0-94.41 39T346.01-480q0 55.33 38.93 94.33t94.41 39ZM480-480Z"/></svg></span>
      <h2>Configuration</h2>
    </div>
    
    
    <div class="config-grid">
  <div class="config-item">
    <label>GCS Bucket:</label>
    <select 
      [(ngModel)]="config.gcsBucket" 
      class="config-input">
      <option value="" disabled>Select a bucket</option>
      <option *ngFor="let bucket of availableBuckets" [value]="bucket">
        {{ bucket }}
      </option>
    </select>
  </div>
  
  <div class="config-item">
    <label>File Type:</label>
    <select 
      [(ngModel)]="config.destinationPath" 
      class="config-input">
      <option value="" disabled>Select destination path</option>
      <option *ngFor="let path of availablePaths" [value]="path">
        {{ path }}
      </option>
    </select>
  </div>
  
  <div class="config-item">
    <label>Max File Size:</label>
    <div class="size-display">{{ config.maxFileSize }} MB</div>
  </div>
  
  <div class="config-item">
    <label>Status:</label>
    <div class="status-display" [class.ready]="config.status.includes('Ready')" 
         [class.uploading]="config.status.includes('Uploading')" 
         [class.success]="config.status.includes('completed')"
         [class.error]="config.status.includes('failed')">
      {{ config.status }}
    </div>
  </div>
</div>
  </div>
  <!-- Drop Zone -->
  <div 
    class="drop-zone"
    [class.drag-over]="isDragOver"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
    (click)="triggerFileInput()">
    
    <div class="drop-zone-content">
      <div class="cloud-upload-icon"><svg xmlns="http://www.w3.org/2000/svg" height="38px" viewBox="0 -960 960 960" width="38px" fill="#2e5ca0"><path d="M440-204.52h80v-169.83l65.13 65.13 56-56.43L480-526.78 318.87-365.65l57 55.43L440-374.35v169.83ZM246.78-60.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-626.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h321.13l251.31 251.31v481.13q0 44.3-30.85 75.15-30.85 30.85-75.15 30.85H246.78Zm266.44-532.44v-200H246.78v626.44h466.44v-426.44h-200Zm-266.44-200v200-200 626.44-626.44Z"/></svg></div>
      <p class="drop-text">Drop files here or click to select</p>
      <p class="file-info">
        Supported formats: {{ allowedExtensions }}<br>
        Maximum file size: {{ config.maxFileSize }} MB
      </p>
      <!-- Select File Button -->
  <!-- Select File Button -->
<div class="button-section">
  <button 
    class="select-file-btn"
    (click)="triggerFileInput(); $event.stopPropagation()"
    [disabled]="isUploading">
    <div class="button-content">
      <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="#FFFFFF">
        <path d="M166.78-140.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-466.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h224.74L480-730.74h313.22q44.3 0 75.15 30.85 30.85 30.85 30.85 75.15v377.96q0 44.3-30.85 75.15-30.85 30.85-75.15 30.85H166.78Zm0-106h626.44v-377.96H436.26l-88.48-88.48h-181v466.44Z"/>
      </svg>
      <span>Select File</span>
    </div>
  </button>
</div>


    </div>

    <!-- Hidden File Input -->
    <input 
      id="fileInput"
      type="file" 
      multiple 
      [accept]="allowedTypes.join(',')"
      (change)="onFileSelected($event)"
      style="display: none;">
  </div>

  


  <!-- Selected Files Preview -->
  <div class="selected-files" *ngIf="selectedFiles.length > 0">
    <h3>Selected Files ({{ selectedFiles.length }})</h3>
    <div class="file-list">
      <div class="file-item" *ngFor="let file of selectedFiles; let i = index">
        <div class="file-info-item">
          <span class="file-name">{{ file.name }}</span>
          <span class="file-size">{{ formatFileSize(file.size) }}</span>
        </div>
        <button class="remove-btn" (click)="removeFile(i)">×</button>
      </div>
    </div>
    <div class="file-actions">
      <button class="upload-btn" (click)="uploadFiles()" [disabled]="isUploading">
        {{ isUploading ? 'Uploading...' : 'Upload Files' }}
      </button>
      <button class="clear-btn" (click)="clearFiles()" [disabled]="isUploading">
        Clear All
      </button>
    </div>
  </div>


  <!-- Upload History Section -->
  <div class="upload-history-section">
    <div class="section-header">
      <span class="history-icon"><svg xmlns="http://www.w3.org/2000/svg" height="25px" viewBox="0 -960 960 960" width="25px" fill="#505558"><path d="M477.27-104.17q-152.52 0-260.62-105.24-108.1-105.23-112.38-257.92h88.63q5.29 115.66 86.85 195.34 81.56 79.67 197.5 79.67 120.84 0 205.26-84.83 84.42-84.83 84.42-206.12 0-119.28-84.85-201.85-84.85-82.56-204.83-82.56-63.06 0-118.96 27.28-55.9 27.28-97.2 74.3h93.48v74.77H122.61v-230.54h73.64v95.03q53.74-60.87 126.47-95.12 72.73-34.24 154.53-34.24 78.01 0 146.76 29.58 68.76 29.58 120.28 80.34 51.51 50.77 81.15 118.85 29.63 68.08 29.63 146.1 0 78.01-29.63 146.76-29.64 68.75-81.15 119.85-51.52 51.1-120.28 80.82-68.75 29.73-146.74 29.73Zm120.19-207.4-153.33-152V-682h73.64v187.33l132.68 130.12-52.99 52.98Z"/></svg></span>
      <h2>Upload History</h2>
    </div>
    
    <div class="history-content" *ngIf="uploadHistory.length > 0; else noUploads">
      <div class="history-item" *ngFor="let file of uploadHistory">
        <div class="history-file-info">
          <div class="history-file-name">{{ file.name }}</div>
          <div class="history-file-details">
            {{ formatFileSize(file.size) }} • {{ file.uploadDate | date:'short' }}
          </div>
        </div>
        <div class="history-status">
          <div class="status-badge" [ngClass]="file.status">
            <span *ngIf="file.status === 'uploading'">⏳ {{ file.progress }}%</span>
            <span *ngIf="file.status === 'success'">✅ Uploaded</span>
            <span *ngIf="file.status === 'error'">❌ Failed</span>
          </div>
          <div class="progress-bar" *ngIf="file.status === 'uploading'">
            <div class="progress-fill" [style.width.%]="file.progress"></div>
          </div>
        </div>
      </div>
    </div>
    
    <ng-template #noUploads>
      <div class="no-uploads">
        <p>No uploads yet</p>
      </div>
    </ng-template>
  </div>
</div>